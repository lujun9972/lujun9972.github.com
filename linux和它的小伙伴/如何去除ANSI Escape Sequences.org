#+TITLE: å¦‚ä½•å»é™¤ANSI Escape Sequences
#+AUTHOR: lujun9972
#+TAGS: linuxå’Œå®ƒçš„å°ä¼™ä¼´
#+DATE: [2020-04-30 å›› 11:53]
#+LANGUAGE:  zh-CN
#+STARTUP:  inlineimages
#+OPTIONS:  H:6 num:nil toc:t \n:nil ::t |:t ^:nil -:nil f:t *:t <:nil

é€šè¿‡ [[https://en.wikipedia.org/wiki/ANSI_escape_code][ANSI Escape Code]] å¯ä»¥è®©ç»ˆç«¯ä¸Šçš„è¾“å‡ºæ›´åŠ åä¸½é†’ç›®ï¼Œä½†æ˜¯å¦ä¸€æ–¹é¢åˆè®©åœ¨è„šæœ¬ä¸­æŠ“å–å†…å®¹å˜å¾—å›°éš¾ã€‚

æœ¬æ–‡é€šè¿‡åˆ†æANSI Escape Codeçš„ç»“æ„æ¥å°è¯•ä½¿ç”¨sedå‘½ä»¤å»é™¤ANSI Escape Sequences.

* ANSI Escape Codeçš„ç»“æ„

é€šå¸¸ï¼Œä¸€ä¸ª ANSI Escape Code æ˜¯ä»¥ =ESC(0x1B)= å¼€å¤´çš„, å…¶ä¸­æœ€å¸¸ç”¨çš„Codeè¢«ç§°ä¸ºCSI(Control Sequence Introducer),æ˜¯ä»¥ =ESC(0x1B)= å’Œ =[(0x5B)= è¿™ä¸¤ä¸ªå­—ç¬¦å¼€å¤´çš„ï¼Œä»¥ =m= å­—ç¬¦ç»“å°¾ï¼Œä¸­é—´åŒ…å«ç€0ä¸ªåˆ°å¤šä¸ªçš„ =SGR= å‚æ•°ã€‚
è¿™äº› =SGR= å‚æ•°å†³å®šäº†è¦å¦‚ä½•è®¾ç½®æ˜¾ç¤ºçš„å±æ€§ï¼Œæ¯ä¸ª =SGR= å‚æ•°ä»¥ =;= è¿›è¡Œåˆ†éš”ã€‚
è€Œä¸”è¿™äº› =SGR= å‚æ•°é€šå¸¸æ¥è¯´æ˜¯1-2ä¸ªæ•°å­—ï¼Œè€Œä¸”å¿½ç•¥çš„è¯ï¼Œåˆ™é»˜è®¤è¡¨ç¤º =0=

å®Œæ•´çš„ANSI Escape Codeçš„å®šä¹‰ç‰¹åˆ«å¤æ‚ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥æŸ¥çœ‹å®ƒçš„ [[https://en.wikipedia.org/wiki/ANSI_escape_code][WikiPedia]] é¡µé¢

* ç”¨sedè¿‡æ»¤æ‰ANSI Escape Code
äº†è§£äº† ANSI Escape Code çš„ç»“æ„åï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•ç”¨ =sed= å¯¹å…¶è¿›è¡Œè¿‡æ»¤äº†ã€‚å…¶è¯­å¥ä¸º:
#+begin_src shell
  sed  "s/\x1b\[([0-9]{1,2})?(;[0-9]{1,2})*m//g"
#+end_src

å…¶ä¸­:
+ =\x1b\[= åŒ¹é… CSI çš„å¼€å¤´éƒ¨åˆ†,è¿™é‡Œ =\x1b= ä½¿ç”¨çš„æ˜¯åå…­è¿›åˆ¶è¡¨ç¤ºæ³•ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¾“å…¥ == (æ–¹æ³•æ˜¯å…ˆæŒ‰ä¸‹Ctrl+v å†æŒ‰ ESC)
+ =([0-9]{1,2})= åŒ¹é… =SGR= éƒ¨åˆ†
+ =([0-9]{1,2})?= è¡¨ç¤º0ä¸ªæˆ–1ä¸ª =SGR=
+ =(;[0-9]{1,2})*= è¡¨ç¤º0ä¸ªæˆ–1ä¸ª =;SGR=
+ =m= åŒ¹é… CSI çš„ç»“å°¾éƒ¨åˆ†
  
å¦‚æœè§‰å¾—å¤ªå¤æ‚ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç®€åŒ–æˆ
#+begin_src shell
  sed 's/\[[^m]*m//g'
#+end_src
