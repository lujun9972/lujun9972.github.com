<!DOCTYPE html>
<html lang="en">
<head>
  <title>把OrangePi打造成tor代理节点 - 暗无天日</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="author" content="lujun9972" />
  <meta name="keywords" content="linux和它的小伙伴" />
  <style>
   #ds-thread #ds-reset .ds-comment-body p {color: #ffffff;}
   #disqus_thread a {color: #00ffff;}
  </style>
  <link rel="stylesheet" media="screen" href="../../../../../media/css/font.css" rel="stylesheet" type="text/css"/>
  <link rel="stylesheet" href="../../../../../media/css/main.css" type="text/css">
  <link rel="stylesheet" href="../../../../../media/css/org-src-fontify.css" type="text/css">
  <link rel="stylesheet" href="../../../../../media/css/kdComment.css" type="text/css">
  <script type="text/javascript"
          src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
</head>

  <body class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="../../../../../">暗无天日</a></h1>
    <p>=============&gt;DarkSun的个人博客</p>
    <nav class="site-nav">
      <div class="menu-icon">
      </div>
      <ul class="trigger">
              <li><a href="../../../../../years/">Years</a></li>
              <li><a href="../../../../../tags/">Tags</a></li>
              <li><a href="../../../../../about/">About</a></li>
              <li><a href="https://github.com/lujun9972/lujun9972.github.com.git">Github</a></li>
              <li><a href="../../../../../rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="http://www.google.com/search">
        <input type="text" class="field" name="q" id="s" placeholder="Search">
        <input type="hidden" name="as_sitesearch" value="lujun9972.github.io">
    </form>
  </header>
</div>

<div>
<div class="post">
<h1 class="title">把OrangePi打造成tor代理节点</h1>
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orga46e691">安装</a></li>
<li><a href="#org81246f0">配置Tor</a></li>
<li><a href="#org5456229">配置浏览器</a></li>
<li><a href="#org4007c6c">最后</a></li>
</ul>
</div>
</div>
<p>
<a href="https://www.torproject.org/">Tor</a> 是什么东西，咱就不多说了，可以看<a href="https://en.wikipedia.org/wiki/Tor_(anonymity_network)">Wiki</a>。
</p>

<div id="outline-container-orga46e691" class="outline-2">
<h2 id="orga46e691">安装</h2>
<div class="outline-text-2" id="text-orga46e691">
<div class="org-src-container">
<pre class="src src-shell">sudo apt install tor -y
</pre>
</div>

<div class="org-src-container">
<pre class="src src-org">Reading package lists... 0%Reading package lists... 100%Reading package lists... Done
Building dependency tree... 0%Building dependency tree... 0%Building dependency tree... 50%Building dependency tree... 50%Building dependency tree... 65%Building dependency tree... 87%Building dependency tree       
Reading state information... 0%Reading state information... 0%Reading state information... Done
Suggested packages:
  mixmaster torbrowser-launcher socat tor-arm apparmor-utils obfs4proxy
Recommended packages:
  tor-geoipdb torsocks
The following NEW packages will be installed:
  tor
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 1,223 kB of archives.
After this operation, 4,223 kB of additional disk space will be used.
&#27;[33m0% [Working]&#27;[0m&#27;[33m0% [Connecting to mirrors.ustc.edu.cn]&#27;[0m&#27;[33m0% [Connecting to mirrors.ustc.edu.cn]&#27;[0m&#27;[33m0% [Connecting to mirrors.ustc.edu.cn]&#27;[0m&#27;[33m0% [Connecting to mirrors.ustc.edu.cn]&#27;[0m&#27;[33m0% [Connecting to mirrors.ustc.edu.cn]&#27;[0m&#27;[33m0% [Connecting to mirrors.ustc.edu.cn]&#27;[0m&#27;[33m0% [Connecting to mirrors.ustc.edu.cn]&#27;[0m&#27;[33m0% [Connecting to mirrors.ustc.edu.cn]&#27;[0m&#27;[33m0% [Connecting to mirrors.ustc.edu.cn]&#27;[0m&#27;[33m0% [Connecting to mirrors.ustc.edu.cn]&#27;[0m&#27;[33m                                      0% [Waiting for headers]&#27;[0m                        Get:1 <span class="org-org-link"><a href="http://mirrors.ustc.edu.cn/ubuntu-ports">http://mirrors.ustc.edu.cn/ubuntu-ports</a></span> bionic/universe arm64 tor arm64 0.3.2.10-1 [1,223 kB]
&#27;[33m0% [1 tor 0 B/1,223 kB 0%]&#27;[0m&#27;[33m17% [1 tor 254 kB/1,223 kB 21%]                                   39.9 kB/s 24s&#27;[0m&#27;[33m48% [1 tor 736 kB/1,223 kB 60%]                                   39.9 kB/s 12s&#27;[0m&#27;[33m65% [1 tor 995 kB/1,223 kB 81%]                                    39.9 kB/s 5s&#27;[0m&#27;[33m100% [Working]                                                     39.9 kB/s 0s&#27;[0m                                                                               Fetched 1,223 kB in 8s (163 kB/s)
Selecting previously unselected package tor.
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 59883 files and directories currently installed.)
Preparing to unpack .../tor_0.3.2.10-1_arm64.deb ...
Unpacking tor (0.3.2.10-1) ...
Setting up tor (0.3.2.10-1) ...
Something or somebody made /var/lib/tor disappear.
Creating one for you again.
Something or somebody made /var/log/tor disappear.
Creating one for you again.
Created symlink /etc/systemd/system/multi-user.target.wants/tor.service &#8594; /lib/systemd/system/tor.service.
Processing triggers for man-db (2.8.3-2ubuntu0.1) ...
Processing triggers for systemd (237-3ubuntu10.39) ...
</pre>
</div>

<p>
这会生成两个service: <code>tor</code> 和 <code>tor@default</code>
</p>
<div class="org-src-container">
<pre class="src src-shell">systemctl status tor.service
systemctl status tor@default.service
</pre>
</div>

<div class="org-src-container">
<pre class="src src-org">&#9679; tor.service - Anonymizing overlay network for TCP (multi-instance-master)
   Loaded: loaded (/lib/systemd/system/tor.service; enabled; vendor preset: enabled)
   Active: active (exited) since Tue 2020-04-07 21:58:27 HKT; 30min ago
 Main PID: 11923 (code=exited, status=0/SUCCESS)
    Tasks: 0 (limit: 1027)
   CGroup: /system.slice/tor.service

Apr 07 21:58:27 orangepipc2 systemd[1]: Starting Anonymizing overlay network&#8230;...
Apr 07 21:58:27 orangepipc2 systemd[1]: Started Anonymizing overlay network &#8230;r).
Hint: Some lines were ellipsized, use -l to show in full.
&#9679; tor@default.service - Anonymizing overlay network for TCP
   Loaded: loaded (/lib/systemd/system/tor@default.service; enabled-runtime; vendor preset: enabled)
   Active: active (running) since Tue 2020-04-07 21:58:29 HKT; 30min ago
 Main PID: 11976 (tor)
    Tasks: 1 (limit: 1027)
   CGroup: /system.slice/system-tor.slice/tor@default.service
           &#9492;&#9472;11976 /usr/bin/tor --defaults-torrc /usr/share/tor/tor-service-d&#8230; 0
</pre>
</div>
</div>
</div>

<div id="outline-container-org81246f0" class="outline-2">
<h2 id="org81246f0">配置Tor</h2>
<div class="outline-text-2" id="text-org81246f0">
<p>
通过查看 <code>man tor</code> 的 <code>FILES</code> 部分，可以看到 <code>Tor</code> 的配置文件为:
</p>
<ul class="org-ul">
<li>/etc/tor/torrc</li>
<li>$HOME/.torrc</li>
</ul>

<p>
在配置文件中输入下面配置信息
</p>
<div class="org-src-container">
<pre class="src src-conf">SocksPort 192.168.1.9:9050    <span class="org-comment-delimiter"># </span><span class="org-comment">192.168.1.9&#26159;OrangePi&#30340;IP&#65292;&#30417;&#21548;&#31471;&#21475;&#20026;9050</span>
SocksPolicy accept 192.168.1.0/24 <span class="org-comment-delimiter"># </span><span class="org-comment">&#20801;&#35768;192.168.1.0/24&#32593;&#27573;&#30340;&#20027;&#26426;&#36830;&#25509;&#21040;&#35813;&#20195;&#29702;</span>
RunAsDaemon 1                     <span class="org-comment-delimiter"># </span><span class="org-comment">&#20197;daemon&#26041;&#24335;&#36816;&#34892;</span>
DataDirectory /var/lib/tor        <span class="org-comment-delimiter"># </span><span class="org-comment">/var/lib/tor &#20013;&#23384;&#20648;&#25968;&#25454;</span>
</pre>
</div>

<p>
然后重启Tor服务
</p>
<div class="org-src-container">
<pre class="src src-shell">sudo systemctl restart tor@default.service
</pre>
</div>
</div>
</div>

<div id="outline-container-org5456229" class="outline-2">
<h2 id="org5456229">配置浏览器</h2>
<div class="outline-text-2" id="text-org5456229">
<p>
在浏览器中设置Sock5代理为OrangePi的地址和9050端口。
</p>

<p>
然后访问 <a href="https://check.torproject.org/">https://check.torproject.org/</a> 就可以检测浏览器是否已经通过Tor网络访问互联网了。
</p>
</div>
</div>

<div id="outline-container-org4007c6c" class="outline-2">
<h2 id="org4007c6c">最后</h2>
<div class="outline-text-2" id="text-org4007c6c">
<p>
经过测试，在墙内似乎是无法访问tor网络的，所以在墙内搭建tor是没有意义的...
</p>
</div>
</div>

</div>
</div>
<div>
  <div class="post-meta">
    <span title="post date" class="post-info">2020-04-07</span>
    <span title="last modification date" class="post-info">2020-04-07</span>
    <span title="tags" class="post-info"><a href="../../../../../tags/linux和它的小伙伴">linux和它的小伙伴</a></span>
    <span title="author" class="post-info">lujun9972</span>
  </div>
  <script src="../../../../../media/js/jquery-2.1.3.min.js"></script>
  <script src="../../../../../media/js/md5.min.js"></script>
  <!-- 添加一叶 -->
  <link href="https://yiyechat.com/open-source/build/content-static/css/main.css" rel="stylesheet">
  <script src="https://yiyechat.com/open-source/build/content-static/js/main.js" ></script>
  <section>
      <div id="gitalk-container"></div>
      <script type="text/javascript">
       var gitalk = new Gitalk({
           clientID: 'fdcb5d9da3f4acb4862c',
           clientSecret: 'dd0a16312a206782cb7669dcec5e96874ab48170',
           repo: 'lujun9972.github.com',
           owner: 'lujun9972',
           admin: ['lujun9972'],
           id: md5(location.pathname),      // Ensure uniqueness and length less than 50
           distractionFreeMode: false  // Facebook-like distraction free mode
       })
       gitalk.render('gitalk-container')
      </script>
  </section>
  <script src="../../../../../media/js/kdComment.js"></script>
      <script>
       var _hmt = _hmt || [];
       (function() {
           var hm = document.createElement("script");
           hm.src = "https://hm.baidu.com/hm.js?7bac4fd0247f69c27887e0d4e3aee41e";
           var s = document.getElementsByTagName("script")[0]; 
           s.parentNode.insertBefore(hm, s);
       })();
      </script>
  <div class="footer">
    <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 27.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
    <p>
      Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:travis &lt;at&gt; travis-job-8e3a98aa-1afc-4214-8cd5-a4565ed1aff4">lujun9972</a>
      &nbsp;&nbsp;-&nbsp;&nbsp;
      Powered by <a href="https://github.com/emacs-china/EGO" target="_blank">EGO</a><br/>
      Themed with <a href="https://github.com/kuangdash/emacs_love" target="_blank">emacs_love</a>
        <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="https://licensebuttons.net/l/by-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License" class="center"></a>
      <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
    </p>
  </div>
    </div>

  </body>
</html>
