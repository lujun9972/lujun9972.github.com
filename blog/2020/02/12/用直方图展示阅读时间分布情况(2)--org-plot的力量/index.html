<!DOCTYPE html>
<html lang="en">
<head>
  <title>用直方图展示阅读时间分布情况(2)--org-plot的力量 - 暗无天日</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="author" content="lujun9972" />
  <meta name="keywords" content="Emacs之怒" />
  <style>
   #ds-thread #ds-reset .ds-comment-body p {color: #ffffff;}
   #disqus_thread a {color: #00ffff;}
  </style>
  <link rel="stylesheet" media="screen" href="../../../../../media/css/font.css" rel="stylesheet" type="text/css"/>
  <link rel="stylesheet" href="../../../../../media/css/main.css" type="text/css">
  <link rel="stylesheet" href="../../../../../media/css/org-src-fontify.css" type="text/css">
  <link rel="stylesheet" href="../../../../../media/css/kdComment.css" type="text/css">
  <script type="text/javascript"
          src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
</head>

  <body class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="../../../../../">暗无天日</a></h1>
    <p>=============&gt;DarkSun的个人博客</p>
    <nav class="site-nav">
      <div class="menu-icon">
      </div>
      <ul class="trigger">
              <li><a href="../../../../../years/">Years</a></li>
              <li><a href="../../../../../tags/">Tags</a></li>
              <li><a href="../../../../../about/">About</a></li>
              <li><a href="https://github.com/lujun9972/lujun9972.github.com.git">Github</a></li>
              <li><a href="../../../../../rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="http://www.google.com/search">
        <input type="text" class="field" name="q" id="s" placeholder="Search">
        <input type="hidden" name="as_sitesearch" value="lujun9972.github.io">
    </form>
  </header>
</div>

<div>
<div class="post">
<h1 class="title">用直方图展示阅读时间分布情况(2)--org-plot的力量</h1>
<p>
之前试着用 <code>chart</code> 库对阅读时间进行了直方图做图，今天发现原来org中直接就支持用gnuplot对表格中的数据进行做图。
</p>

<p>
首先我们直接利用Org的clocktable功能对各个标题下的时间进行统计，方法是在文件头加上下面两句话
</p>
<div class="org-src-container">
<pre class="src src-org"><span class="org-org-meta-line">#+BEGIN: clocktable :scope file :maxlevel 1</span>
<span class="org-org-meta-line">#+END:</span>
</pre>
</div>
<p>
其中 <code>:scope file</code> 表示只使用本文件的数据进行统计， <code>:maxlevel 1</code> 表示只统计一级标题的耗时。
</p>

<p>
然后按下 <code>C-c C-c</code>,就会变成下面这样:
</p>
<div class="org-src-container">
<pre class="src src-org"><span class="org-org-meta-line">#+BEGIN: clocktable :scope file :maxlevel 1</span>
<span class="org-org-meta-line">#+CAPTION:</span> <span class="org-org-block">Clock summary at [2020-02-12 &#19977; 15:51]</span>
<span class="org-org-table">| Headline                                  |       Time |</span>
<span class="org-org-table">|-------------------------------------------+------------|</span>
<span class="org-org-table">| </span><span class="org-org-table"><span class="org-bold">*Total time*</span></span><span class="org-org-table">                              | </span><span class="org-org-table"><span class="org-bold">*3d 16:32*</span></span><span class="org-org-table"> |</span>
<span class="org-org-table">|-------------------------------------------+------------|</span>
<span class="org-org-table">| The Linux Philosophy for SysAdmins        |    1d 2:29 |</span>
<span class="org-org-table">| Personal Finance with Python              |       5:10 |</span>
<span class="org-org-table">| Company of One                            |    1d 2:17 |</span>
<span class="org-org-table">| A One Person Business                     |       5:44 |</span>
<span class="org-org-table">| Knowledge Management In Practice          |       3:14 |</span>
<span class="org-org-table">| Java&#20837;&#38376;123                               |       0:57 |</span>
<span class="org-org-table">| Unix&#19982;Internte&#23433;&#20840;&#23454;&#36341;&#25351;&#21335;                |       0:10 |</span>
<span class="org-org-table">| &#38405;&#35835;&#12298;&#21051;&#24847;&#32451;&#20064;--&#22914;&#20309;&#20174;&#26032;&#25163;&#21040;&#22823;&#24072;&#12299; </span><span class="org-org-checkbox-statistics-todo">[0/10]</span><span class="org-org-table"> |       2:37 |</span>
<span class="org-org-table">| Forge Your Future with Open Source        |       1:47 |</span>
<span class="org-org-table">| I heart Log                               |       3:53 |</span>
<span class="org-org-table">| HOW TO START A BLOG THAT PEOPLE WILL...   |       0:51 |</span>
<span class="org-org-table">| </span><span class="org-org-table"><span class="org-underline">_Blogging_100_Success_Secrets_</span></span><span class="org-org-table">            |       1:36 |</span>
<span class="org-org-table">| write your way to success                 |       2:44 |</span>
<span class="org-org-table">| Web Analytics For Dummies                 |       0:51 |</span>
<span class="org-org-table">| &#22823;&#33041;&#20351;&#29992;&#25351;&#21335;                              |       0:16 |</span>
<span class="org-org-table">| Developing Game on the Raspberry Pi       |       0:33 |</span>
<span class="org-org-table">| &#28145;&#20837;&#27973;&#20986;&#25968;&#25454;&#20998;&#26512;                          |       2:48 |</span>
<span class="org-org-table">| X power tools                             |       2:25 |</span>
<span class="org-org-table">| &#27599;&#22825;&#33410;&#30465;&#20004;&#23567;&#26102;                            |       0:10 |</span>
<span class="org-org-meta-line">#+END:</span>
</pre>
</div>

<p>
然后我们把这个表格复制出来，加上 <code>#+PLOT:</code> 头,变成这样:
</p>
<div class="org-src-container">
<pre class="src src-org"><span class="org-org-meta-line">#+PLOT: title:"&#38405;&#35835;&#26102;&#38388;" ind:1 deps:(2) type:2d with:histograms </span>
<span class="org-org-table">| Headline                                  |       Time |</span>
<span class="org-org-table">|-------------------------------------------+------------|</span>
<span class="org-org-table">| </span><span class="org-org-table"><span class="org-bold">*Total time*</span></span><span class="org-org-table">                              | </span><span class="org-org-table"><span class="org-bold">*3d 16:32*</span></span><span class="org-org-table"> |</span>
<span class="org-org-table">|-------------------------------------------+------------|</span>
<span class="org-org-table">| The Linux Philosophy for SysAdmins        |    1d 2:29 |</span>
<span class="org-org-table">| Personal Finance with Python              |       5:10 |</span>
<span class="org-org-table">| Company of One                            |    1d 2:17 |</span>
<span class="org-org-table">| A One Person Business                     |       5:44 |</span>
<span class="org-org-table">| Knowledge Management In Practice          |       3:14 |</span>
<span class="org-org-table">| Java&#20837;&#38376;123                               |       0:57 |</span>
<span class="org-org-table">| Unix&#19982;Internte&#23433;&#20840;&#23454;&#36341;&#25351;&#21335;                |       0:10 |</span>
<span class="org-org-table">| &#38405;&#35835;&#12298;&#21051;&#24847;&#32451;&#20064;--&#22914;&#20309;&#20174;&#26032;&#25163;&#21040;&#22823;&#24072;&#12299; </span><span class="org-org-checkbox-statistics-todo">[0/10]</span><span class="org-org-table"> |       2:37 |</span>
<span class="org-org-table">| Forge Your Future with Open Source        |       1:47 |</span>
<span class="org-org-table">| I heart Log                               |       3:53 |</span>
<span class="org-org-table">| HOW TO START A BLOG THAT PEOPLE WILL...   |       0:51 |</span>
<span class="org-org-table">| </span><span class="org-org-table"><span class="org-underline">_Blogging_100_Success_Secrets_</span></span><span class="org-org-table">            |       1:36 |</span>
<span class="org-org-table">| write your way to success                 |       2:44 |</span>
<span class="org-org-table">| Web Analytics For Dummies                 |       0:51 |</span>
<span class="org-org-table">| &#22823;&#33041;&#20351;&#29992;&#25351;&#21335;                              |       0:16 |</span>
<span class="org-org-table">| Developing Game on the Raspberry Pi       |       0:33 |</span>
<span class="org-org-table">| &#28145;&#20837;&#27973;&#20986;&#25968;&#25454;&#20998;&#26512;                          |       2:48 |</span>
<span class="org-org-table">| X power tools                             |       2:25 |</span>
<span class="org-org-table">| &#27599;&#22825;&#33410;&#30465;&#20004;&#23567;&#26102;                            |       0:10 |</span>
</pre>
</div>

<p>
然后在表格上执行 <code>org-plot/gnuplot</code> 就可以得到结果:
<img src="images/read-graph-by-org-gnuplot.png" alt="read-graph-by-org-gnuplot.png" />
</p>

<p>
可以看到，X轴的显示还是好乱～～～～
</p>


<p>
默认情况下,Org Plot会自动把表格的标题作为生成图表的标签. 但是通过表格前的#+PLOT:行,你可以定义plot的标签,类型,内容和展示. 下面列出了Org-plot选项的说明：
</p>

<dl class="org-dl">
<dt>set</dt><dd>用于设置绘图时的gnuplot选项</dd>
<dt>title</dt><dd>指定plot的标题</dd>
<dt>ind</dt><dd>指定表格的哪一列作为x轴</dd>
<dt>deps</dt><dd>指定描绘哪些列,该设置的格式类似于Lisp中的list,由小括号括起来,内部用空格分隔,例如'dep:(3 4)'指定只描绘第3,4列(默认情况下,除了指明为ind的列,其他的列都会被描绘)</dd>
<dt>type</dt><dd>指定plot是2d还是3d还是grid的</dd>
<dt>with</dt><dd>对每一个要被绘制的列都插入一个指定的with选项(例如,lines,points,boxes,impulses,等等). 默认值为lines</dd>
<dt>file</dt><dd>如果你想将描绘输出成一个文件,指定输出文件的路径</dd>
<dt>labels</dt><dd>用一个列表指定各输出列的标签(默认情况下,如果列的标题村爱的话,使用列标题作为标签)</dd>
<dt>line</dt><dd>在gnuplot脚本中插入指定的一整行(Specify an entire line to be inserted in the Gnuplot script. )</dd>
<dt>map</dt><dd>当描绘类型为3d或grid时,该选项的值设为t则在描绘时描绘的是一个平面映射而不是3维图形(set this to t to graph a flat mapping rather than a 3d slope)</dd>
<dt>timefmt</dt><dd>指定Org-mode的时间戳格式,因为它们会被Gnuplot所解析,默认格式为'%Y-%m-%d-%H:%M:%S'</dd>
<dt>script</dt><dd>如果你想实现完全的自定义,你可以指定一个脚本文件(把文件名放在双引号内)来实现描绘动作. 在正真描绘之前,这个特定脚本中的每个'$datafile'会被替换成生成的数据文件的实际路径. 注意:即使你设置了这个选项,你也可能仍然需要定义plot的type,因为这个选项会影响到生成的数据文件的内容.</dd>
</dl>

</div>
</div>
<div>
  <div class="post-meta">
    <span title="post date" class="post-info">2020-02-12</span>
    <span title="last modification date" class="post-info">2020-02-12</span>
    <span title="tags" class="post-info"><a href="../../../../../tags/emacs之怒">Emacs之怒</a></span>
    <span title="author" class="post-info">lujun9972</span>
  </div>
  <script src="../../../../../media/js/jquery-2.1.3.min.js"></script>
  <script src="../../../../../media/js/md5.min.js"></script>
  <!-- 添加一叶 -->
  <link href="https://yiyechat.com/open-source/build/content-static/css/main.css" rel="stylesheet">
  <script src="https://yiyechat.com/open-source/build/content-static/js/main.js" ></script>
  <section>
      <div id="gitalk-container"></div>
      <script type="text/javascript">
       var gitalk = new Gitalk({
           clientID: 'fdcb5d9da3f4acb4862c',
           clientSecret: 'dd0a16312a206782cb7669dcec5e96874ab48170',
           repo: 'lujun9972.github.com',
           owner: 'lujun9972',
           admin: ['lujun9972'],
           id: md5(location.pathname),      // Ensure uniqueness and length less than 50
           distractionFreeMode: false  // Facebook-like distraction free mode
       })
       gitalk.render('gitalk-container')
      </script>
  </section>
  <script src="../../../../../media/js/kdComment.js"></script>
      <script>
       var _hmt = _hmt || [];
       (function() {
           var hm = document.createElement("script");
           hm.src = "https://hm.baidu.com/hm.js?7bac4fd0247f69c27887e0d4e3aee41e";
           var s = document.getElementsByTagName("script")[0]; 
           s.parentNode.insertBefore(hm, s);
       })();
      </script>
  <div class="footer">
    <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 27.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
    <p>
      Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:travis &lt;at&gt; travis-job-417d9633-0189-41c3-97bc-68e7d28f563a">lujun9972</a>
      &nbsp;&nbsp;-&nbsp;&nbsp;
      Powered by <a href="https://github.com/emacs-china/EGO" target="_blank">EGO</a><br/>
      Themed with <a href="https://github.com/kuangdash/emacs_love" target="_blank">emacs_love</a>
        <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="https://licensebuttons.net/l/by-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License" class="center"></a>
      <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
    </p>
  </div>
    </div>

  </body>
</html>
