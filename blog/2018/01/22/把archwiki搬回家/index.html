<!DOCTYPE html>
<html lang="en">
<head>
  <title>把archwiki搬回家 - 暗无天日</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="author" content="lujun9972" />
  <meta name="keywords" content="linux和它的小伙伴" />
  <style>
   #ds-thread #ds-reset .ds-comment-body p {color: #ffffff;}
   #disqus_thread a {color: #00ffff;}
  </style>
  <link rel="stylesheet" media="screen" href="/media/css/font.css" rel="stylesheet" type="text/css"/>
  <link rel="stylesheet" href="/media/css/main.css" type="text/css">
  <link rel="stylesheet" href="/media/css/kdComment.css" type="text/css">
  <script type="text/javascript"
          src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
</head>

  <body class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="/">暗无天日</a></h1>
    <p>=============&gt;随便,谢谢</p>
    <nav class="site-nav">
      <div class="menu-icon">
      </div>
      <ul class="trigger">
              <li><a href="/years/">Years</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/tags/">Tags</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="https://github.com/lujun9972/lujun9972.github.com">Github</a></li>
              <li><a href="/rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="http://www.google.com/search">
        <input type="text" class="field" name="q" id="s" placeholder="Search">
        <input type="hidden" name="as_sitesearch" value="lujun9972.github.io">
    </form>
  </header>
</div>

<div>
<div class="post">
<h1 class="title">把archwiki搬回家</h1>
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org502144f">使用wiki-search搜索离线wiki</a></li>
</ul>
</div>
</div>
<p>
archlinux最令人惊叹的莫过于它完善的wiki了。今天偶然发现archlinux上有两个package分别为 <code>arch-wiki-lite</code> 和 <code>arch-wiki-docs</code>,装好之后就能在本地浏览archwiki了。
</p>

<p>
关于 <code>arch-wiki-lite</code> 和 <code>arch-wiki-docs</code> 这两个package的描述为：
</p>
<pre class="example">
[lujun9972@T520 ~]$ pacman -Ss arch-wiki
community/arch-wiki-docs 20180105-1 [已安装]
    Pages from Arch Wiki optimized for offline browsing
community/arch-wiki-lite 20170410-1 [已安装]
    The wiki without html. 1/9 as big, easily searched and viewable on console.
</pre>

<p>
其中 <code>arch-wiki-docs</code> 提供了离线的html格式的文档，而且文档较新，而 <code>arch-wiki-lite</code> 提供的是文本格式的文档，而且提供了 <code>wiki-search</code> 和 <code>wiki-search-html</code> 两个工具来搜索wiki。
</p>

<div id="outline-container-org502144f" class="outline-2">
<h2 id="org502144f">使用wiki-search搜索离线wiki</h2>
<div class="outline-text-2" id="text-org502144f">
<p>
直接运行 <code>wiki-search</code> 会列出使用说明
</p>

<pre class="example">
wiki-search
Search and view your local copy of the Arch wiki.

Search with 'wiki-search [query]' where query is a regex
or a list of terms to match individually.
If 'dialog' is not installed you will have to choose
pages with 'wiki-search [number]' where number can be a search
result (0-9), partial ID (NNNN), or full ID (0000NNNN).
Regex is case insensitive.
See every page title with --all.
Get a summary of languages with --lang.
Viewer is 'less' or $PAGER.  $PAGER disables colored output.
Access non-english pages by exporting $wiki_lang first.
Force the width (and bypass dialog) by exporting $wiki_width.
</pre>

<p>
最简单的方法就是直接带上要搜索的内容,比如要搜索pacman相关内容可以：
</p>
<div class="org-src-container">
<pre class="src src-sh">wiki-search pacman
</pre>
</div>

<p>
在安装了 <code>dialog</code> 的情况下，会显示一个选择框，列出了所有包含关键字的主题让你选择，如下图所示
</p>


<div class="figure">
<p><img src="/assets/blog/2018/01/22/把archwiki搬回家/screenshot-04.png" alt="screenshot-04.png" />
</p>
</div>

<p>
将光标移动到要查看的主题上按下回车后就会显示具体内容了
</p>


<div class="figure">
<p><img src="/assets/blog/2018/01/22/把archwiki搬回家/screenshot-06.png" alt="screenshot-06.png" />
</p>
</div>

<p>
按下 <code>SPACE</code> 或 <code>PAGEDOWN</code> 向下翻页，按下 <code>b</code> 或 <code>PAGEUP</code> 向上翻页
</p>

<p>
按下 <code>j</code> 向下一行，按下 <code>k</code> 向上一行
</p>

<p>
除了搜索英文资料外，还能搜索中文资料:
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #7590db;">wiki_lang</span>=zh-CN wiki-search pacman
</pre>
</div>

<div class="figure">
<p><img src="/assets/blog/2018/01/22/把archwiki搬回家/screenshot-07.png" alt="screenshot-07.png" />
</p>
</div>


<div class="figure">
<p><img src="/assets/blog/2018/01/22/把archwiki搬回家/screenshot-09.png" alt="screenshot-09.png" />
</p>
</div>

<p>
不过，并不推荐搜索中文wiki，资料更新慢是一方面，最关键是中文字的截断很明显是有问题的。
</p>

<p>
如何真的想看中文资料，推荐使用 <code>wiki-search-html</code> 来代替 <code>wiki-search</code>,它唯一的区别是用浏览器打开相应的html页面来看，至少不存在中文字截断的问题。
</p>

<p>
而如果没有安装 <code>dialog</code> 则 <code>wiki-search</code> 会列出每个主题对应的编号，
</p>
<pre class="example">
Now choose a page with wiki-search [number]

0  Pacman                                             00003045
1  Pacman/Tips and tricks                             00004600
2  Pacman/Rosetta                                     00004598
3  Pacman/Package signing                             00004597
4  Migrating between architectures                    00004127
5  DeveloperWiki:Package Signing Proposal for Pacman  00003237
6  Mirrors                                            00002732
7  System maintenance                                 00003087
8  Pacman/Restore local database                      00004601
9  Update packages from crontab                       00004151
</pre>
<p>
然后需要你再执行一次 <code>wiki-search 编号</code> 来查看具体的内容。
</p>
<div class="org-src-container">
<pre class="src src-shell">wiki-search <span style="color: #a45bad;">00003045</span>
</pre>
</div>

<p>
通过 <code>--lang</code> 可以查看每种语言的资料数
</p>
<div class="org-src-container">
<pre class="src src-shell">wiki-search --lang
</pre>
</div>

<p>
结果为
</p>
<div class="org-src-container">
<pre class="src src-org">2240 en
 570 zh-CN
 530 ru
 429 es
 350 it
 153 cs
 130 zh-TW
 105 pt
  87 ko
  80 uk
  77 el
  74 ar
  71 pl
  65 sr
  49 nl
  37 sk
  31 hu
  30 da
  27 lt
  25 th
  25 bg
  24 id
  12 hr
  11 he
   6 fi
   6 eo
   4 ca
   1 sv
   1 nb
</pre>
</div>

<p>
可以看到最多的是英文资料，有两千多篇。而排在第二的居然是中文有570篇。
</p>
</div>
</div>

</div>
</div>
<div>
  <div class="post-meta">
    <span title="post date" class="post-info">2018-01-22</span>
    <span title="last modification date" class="post-info">2018-01-22</span>
    <span title="tags" class="post-info"><a href="/tags/linux和它的小伙伴">linux和它的小伙伴</a></span>
    <span title="author" class="post-info">lujun9972</span>
  </div>
  <script src="/media/js/jquery-2.1.3.min.js"></script>
  <script src="/media/js/md5.min.js"></script>
  <section>
      <div id="gitalk-container"></div>
      <script type="text/javascript">
       var gitalk = new Gitalk({
           clientID: 'fdcb5d9da3f4acb4862c',
           clientSecret: 'dd0a16312a206782cb7669dcec5e96874ab48170',
           repo: 'lujun9972.github.com',
           owner: 'lujun9972',
           admin: ['lujun9972'],
           id: md5(location.pathname),      // Ensure uniqueness and length less than 50
           distractionFreeMode: false  // Facebook-like distraction free mode
       })
       gitalk.render('gitalk-container')
      </script>
  </section>
  <script src="/media/js/kdComment.js"></script>
      <script>
       var _hmt = _hmt || [];
       (function() {
           var hm = document.createElement("script");
           hm.src = "https://hm.baidu.com/hm.js?7bac4fd0247f69c27887e0d4e3aee41e";
           var s = document.getElementsByTagName("script")[0]; 
           s.parentNode.insertBefore(hm, s);
       })();
      </script>
  <div class="footer">
    <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 26.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
    <p>
      Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:lujun9972 &lt;at&gt; T520">lujun9972</a>
      &nbsp;&nbsp;-&nbsp;&nbsp;
      Powered by <a href="https://github.com/emacs-china/EGO" target="_blank">EGO</a><br/>
      Themed with <a href="https://github.com/kuangdash/emacs_love" target="_blank">emacs_love</a>
        <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License" class="center"></a>
      <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
    </p>
  </div>
    </div>

  </body>
</html>
