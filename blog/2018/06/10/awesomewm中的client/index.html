<!DOCTYPE html>
<html lang="en">
<head>
  <title>AwesomeWM中的client - 暗无天日</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="author" content="lujun9972" />
  <meta name="keywords" content="linux和它的小伙伴" />
  <style>
   #ds-thread #ds-reset .ds-comment-body p {color: #ffffff;}
   #disqus_thread a {color: #00ffff;}
  </style>
  <link rel="stylesheet" media="screen" href="../../../../../media/css/font.css" rel="stylesheet" type="text/css"/>
  <link rel="stylesheet" href="../../../../../media/css/main.css" type="text/css">
  <link rel="stylesheet" href="../../../../../media/css/org-src-fontify.css" type="text/css">
  <link rel="stylesheet" href="../../../../../media/css/kdComment.css" type="text/css">
  <script type="text/javascript"
          src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
</head>

  <body class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="../../../../../">暗无天日</a></h1>
    <p>=============&gt;随便,谢谢</p>
    <nav class="site-nav">
      <div class="menu-icon">
      </div>
      <ul class="trigger">
              <li><a href="../../../../../years/">Years</a></li>
              <li><a href="../../../../../tags/">Tags</a></li>
              <li><a href="../../../../../about/">About</a></li>
              <li><a href="https://github.com/lujun9972/lujun9972.github.com.git">Github</a></li>
              <li><a href="../../../../../rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="http://www.google.com/search">
        <input type="text" class="field" name="q" id="s" placeholder="Search">
        <input type="hidden" name="as_sitesearch" value="lujun9972.github.io">
    </form>
  </header>
</div>

<div>
<div class="post">
<h1 class="title">AwesomeWM中的client</h1>
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org668f84a">client的常用操作</a>
<ul>
<li><a href="#orgf1ecf24">获取当前的client</a></li>
<li><a href="#org529929a">获取client列表</a>
<ul>
<li><a href="#orgb9ced94">获取所有的client列表</a></li>
<li><a href="#org82154fe">获取符合某个条件的client列表</a></li>
<li><a href="#orgfba5dcf">获取某个screen上的client列表</a></li>
</ul>
</li>
<li><a href="#org8809bce">获取窗口的位置与大小</a></li>
<li><a href="#org9cdc5cf">设置某个窗口的位置和大小</a></li>
<li><a href="#org126378b">raise</a></li>
<li><a href="#org7d15955">lower</a></li>
<li><a href="#orgdc67e67">run or raise</a></li>
<li><a href="#org3375ce2">给某个client设置鼠标操作</a></li>
<li><a href="#orgb6f18b3">给某个client设置快捷键</a></li>
<li><a href="#orgaba8bcc">关闭某个client</a></li>
<li><a href="#org69f4c90">为某个client设置所属tag</a></li>
<li><a href="#orgaf6657b">移动client到某个tag</a></li>
</ul>
</li>
<li><a href="#org64a61b5">client中的signal处理</a></li>
</ul>
</div>
</div>
<p>
Awesome WM 使用 client 类来指代 XClient 应用程序的一个窗口。
</p>

<p>
一个应用程序可能有多个窗口，也就有多个 client 对象与之相对应。 这些 client 对象通常有相同的 class 属性。 我们可以通过 <code>xprop</code> 命令来查询某个 client 的属性。
</p>

<p>
一个clinet对象中包含了多个属性，这些属性包括:
</p>

<dl class="org-dl">
<dt>window</dt><dd>X window ID</dd>
<dt>name</dt><dd>client title</dd>
<dt>skip_taskbar</dt><dd>是否在任务栏上显示</dd>
<dt>type</dt><dd>窗口类型，可能是 desktop, docker, splash, dialog, menu, toolbar, utility, dropdown_menu, popup_menu, notification, combo, dnd, normal. 详情可以参见<a href="https://specifications.freedesktop.org/wm-spec/wm-spec-latest.html#idm140200472629520">这里</a></dd>
<dt>class</dt><dd>client的第一个class属性，可以通过 xprop 命令获取</dd>
<dt>instance</dt><dd>client的instance属性，可以通过 xprop 命令获取</dd>
<dt>pid</dt><dd>client的PID</dd>
<dt>role</dt><dd>The window role, if available(没太明白什么意思).</dd>
<dt>machine</dt><dd>运行client所在的机器</dd>
<dt>icon_name</dt><dd>当缩小成图标时的client name</dd>
<dt>icon</dt><dd>client所使用的图标路径</dd>
<dt>icon_sizes</dt><dd>一个数组，包含了icon可用的所有尺寸大小</dd>
<dt>screen</dt><dd>client所在的screen</dd>
<dt>hidden</dt><dd>该client是否隐藏</dd>
<dt>minimized</dt><dd>该client是否最小化。最小化的client只在任务栏上可见</dd>
<dt>size_hints_honor</dt><dd>Honor size hints</dd>
<dt>border_width</dt><dd>client边框宽度</dd>
<dt>border_color</dt><dd>client边框颜色</dd>
<dt>urgent</dt><dd>client的urgent标志，true/false</dd>
<dt>content</dt><dd>A cairo surface for the client window content.
可以用它来进行截屏 <code>gears.surface(c.content):write_to_png(path)</code></dd>
<dt>opacity</dt><dd>透明度，0为完全透明，1为完全不透明</dd>
<dt>ontop</dt><dd>该client是否在所有窗口的最前面</dd>
<dt>above</dt><dd>该client是否设为居前(The client is above normal windows.)</dd>
<dt>below</dt><dd>该client是否设为据后(The client is below normal windows. )</dd>
<dt>fullscreen</dt><dd>该client是否全屏显示</dd>
<dt>maximized</dt><dd>该client是否最大化</dd>
<dt>maximized_horizontal</dt><dd>该client是否水平最大化</dd>
<dt>maximized_vertical</dt><dd>该client是否垂直最大化</dd>
<dt>transient_for</dt><dd>The client the window is transient for.(没看懂)</dd>
<dt>group_window</dt><dd>window所属组ID</dd>
<dt>leader_window</dt><dd>当一个命令产生多个client时，这些client共享同一个leader_window</dd>
<dt>size_hints</dt><dd>client的推荐大小(A table with size hints of the client. )</dd>
<dt>sticky</dt><dd>设置client是否sticky，一个sticky的client在所有tags下都可见</dd>
<dt>modal</dt><dd>Indicate if the client is modal.</dd>
<dt>focusable</dt><dd>该client是否能获取到焦点</dd>
<dt>shape_bounding</dt><dd>The client's bounding shape as set by awesome as a (native) cairo surface.</dd>
<dt>shape_clip</dt><dd>The client's clip shape as set by awesome as a (native) cairo surface.</dd>
<dt>client.shape_input</dt><dd>The client's input shape as set by awesome as a (native) cairo surface.</dd>
<dt>shape_client_bounding</dt><dd>The client's bounding shape as set by the program as a (native) cairo surface.</dd>
<dt>shape_client_clip</dt><dd>The client's clip shape as set by the program as a (native) cairo surface.</dd>
<dt>startup_id</dt><dd>The FreeDesktop StartId.</dd>
<dt>valid</dt><dd>该client是否由awesome WM所管理着</dd>
<dt>first_tag</dt><dd>该client所属的第一个tag，相当于 <code>c:tags()[1]</code></dd>
<dt>marked</dt><dd>该client是否被标记</dd>
<dt>is_fixed</dt><dd>该client的大小是否被锁定，该属性为只读的</dd>
<dt>floating</dt><dd>该client是否为浮动的</dd>
<dt>x / y</dt><dd>该client在screen上的偏移量</dd>
<dt>width / height</dt><dd>该client的尺寸</dd>
<dt>dockable</dt><dd>If the client is dockable. A dockable client is an application confined to the edge of the screen. The space it occupies is substracted from the screen.workarea.</dd>
<dt>shape</dt><dd>设置client的形状，请参见<a href="https://awesomewm.org/doc/api/libraries/gears.shape.html#">gears.shape</a></dd>
</dl>

<p>
需要说明的是，修改client对象的属性可能会对窗口本身产生影响，比如设置
</p>
<div class="org-src-container">
<pre class="src src-lua">c.maximized=<span class="org-constant">true</span>
</pre>
</div>
<p>
会让该client最大化
</p>

<div id="outline-container-org668f84a" class="outline-2">
<h2 id="org668f84a">client的常用操作</h2>
<div class="outline-text-2" id="text-org668f84a">
</div>
<div id="outline-container-orgf1ecf24" class="outline-3">
<h3 id="orgf1ecf24">获取当前的client</h3>
<div class="outline-text-3" id="text-orgf1ecf24">
<p>
client.focus对象总是代表当前获取焦点的窗口
</p>
<div class="org-src-container">
<pre class="src src-lua"><span class="org-keyword">local</span> <span class="org-variable-name">c</span> = client.focus
<span class="org-keyword">if</span> c <span class="org-keyword">then</span>
  <span class="org-comment-delimiter">-- </span><span class="org-comment">&#22788;&#29702;&#24403;&#21069;client</span>
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org529929a" class="outline-3">
<h3 id="org529929a">获取client列表</h3>
<div class="outline-text-3" id="text-org529929a">
</div>
<div id="outline-container-orgb9ced94" class="outline-4">
<h4 id="orgb9ced94">获取所有的client列表</h4>
<div class="outline-text-4" id="text-orgb9ced94">
<p>
client.get函数可以返回一个包含所有client对象的数组
</p>
<div class="org-src-container">
<pre class="src src-lua"><span class="org-keyword">for</span> <span class="org-variable-name">_</span>,<span class="org-variable-name">c</span> <span class="org-keyword">in</span> <span class="org-builtin">ipairs</span>(client.get()) <span class="org-keyword">do</span>
  <span class="org-comment-delimiter">--</span><span class="org-comment">do something</span>
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org82154fe" class="outline-4">
<h4 id="org82154fe">获取符合某个条件的client列表</h4>
<div class="outline-text-4" id="text-org82154fe">
<p>
awful.client.iterate(filter,start,s) 可以获取符合 filter 条件的 client列表，其中
</p>

<dl class="org-dl">
<dt>filter</dt><dd>为条件过滤函数</dd>
<dt>start</dt><dd>标识了从哪个client开始进行过滤，nil则表示当前获取焦点的client</dd>
<dt>s</dt><dd>限制了只返回哪个screen上的client，nil表示所有的screen</dd>
</dl>

<p>
例如下面代码会取消所有 URxvt 应用窗口的最小化状态:
</p>
<div class="org-src-container">
<pre class="src src-lua"><span class="org-comment-delimiter">-- </span><span class="org-comment">un-minimize all urxvt instances</span>
<span class="org-keyword">local</span> <span class="org-function-name">urxvt</span> = <span class="org-keyword">function</span> (c)
  <span class="org-keyword">return</span> awful.rules.match(c, {class = <span class="org-string">"URxvt"</span>})
<span class="org-keyword">end</span>

<span class="org-keyword">for</span> <span class="org-variable-name">c</span> <span class="org-keyword">in</span> awful.client.iterate(urxvt) <span class="org-keyword">do</span>
  c.minimized = <span class="org-constant">false</span>
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfba5dcf" class="outline-4">
<h4 id="orgfba5dcf">获取某个screen上的client列表</h4>
<div class="outline-text-4" id="text-orgfba5dcf">
<ul class="org-ul">
<li>screen对象中的 <code>clients</code> 属性就是该screen上所有可见client的数组</li>
<li>screen对象中的 <code>hidden_clients</code> 属性就是该screen上所有不可见client的数组</li>
<li>screen对象中的 <code>all_clients</code> 属性就是该screen上所有client的数组</li>
<li>screen对象中的 <code>tiled_clients</code> 属性就是该screen上所有被平铺的client的数组</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org8809bce" class="outline-3">
<h3 id="org8809bce">获取窗口的位置与大小</h3>
<div class="outline-text-3" id="text-org8809bce">
<p>
<code>client:geometry()</code> 方法返回一个包含 <code>x</code>, <code>y</code>, <code>width</code>, <code>height</code> key 的table, 指示了窗口(不包括边框宽度)在屏幕上的偏移量和长度与宽度。
</p>
<div class="org-src-container">
<pre class="src src-lua"><span class="org-keyword">local</span> <span class="org-variable-name">c</span> = client.focus
<span class="org-keyword">if</span> c <span class="org-keyword">then</span>
  x,y,width,height = c:geometry()
  naughty.notify{text=<span class="org-builtin">string</span>.<span class="org-builtin">format</span>(<span class="org-string">"x=%s,y=%s,w=%s,h=%s"</span>,x,y,width,height)}
<span class="org-keyword">end</span>
</pre>
</div>

<p>
另外，也可以直接访问client对象的 <code>x</code>, <code>y</code>, <code>width</code>, 和 <code>height</code> 属性来获取相应的指
</p>
</div>
</div>

<div id="outline-container-org9cdc5cf" class="outline-3">
<h3 id="org9cdc5cf">设置某个窗口的位置和大小</h3>
<div class="outline-text-3" id="text-org9cdc5cf">
<p>
<code>client:geometry(geo)</code> 方法也能用来设置窗口的位置和大小。
方法是先设置好一个包含 <code>x</code>, <code>y</code>, <code>width</code>, <code>height</code> key 的table,然后使用它作为参数传递给 <code>geometry</code> 方法
</p>
</div>
</div>

<div id="outline-container-org126378b" class="outline-3">
<h3 id="org126378b">raise</h3>
<div class="outline-text-3" id="text-org126378b">
<p>
client::raise() 方法可以唤起指定client，让它处于其他client的最上方。
</p>
</div>
</div>

<div id="outline-container-org7d15955" class="outline-3">
<h3 id="org7d15955">lower</h3>
<div class="outline-text-3" id="text-org7d15955">
<p>
client::lower() 方法让该client向下降一级
</p>
</div>
</div>

<div id="outline-container-orgdc67e67" class="outline-3">
<h3 id="orgdc67e67">run or raise</h3>
<div class="outline-text-3" id="text-orgdc67e67">
<p>
awful.client.run_or_raise(cmd,matcher,merge) 函数可以在当某个符合条件的client存在时切换到该client，否则通过执行命令的方式运行新应用。 其中:
</p>
<dl class="org-dl">
<dt>cmd</dt><dd>为没有找到匹配的client时执行的命令</dd>
<dt>matcher</dt><dd>为匹配函数，它接受一个client对象作为参数，返回true或false</dd>
<dt>merge</dt><dd>bool or function If true then merge tags (select the client's first tag additionally) when the client is not visible. If it is a function, it will be called with the client as argument.</dd>
</dl>

<p>
比如，下面操作当有URxvt窗口存在时，弹出该窗口，否则运行一个新 <code>urxvt</code> 应用:
</p>
<div class="org-src-container">
<pre class="src src-lua"><span class="org-keyword">local</span> <span class="org-function-name">matcher</span> = <span class="org-keyword">function</span> (c)
  <span class="org-keyword">return</span> awful.rules.match(c, {class = <span class="org-string">'URxvt'</span>})
<span class="org-keyword">end</span>
awful.client.run_or_raise(<span class="org-string">'urxvt'</span>, matcher)
</pre>
</div>
</div>
</div>

<div id="outline-container-org3375ce2" class="outline-3">
<h3 id="org3375ce2">给某个client设置鼠标操作</h3>
<div class="outline-text-3" id="text-org3375ce2">
<p>
client:buttons (buttons_array) 方法可以获取/设置某个client快捷键
</p>
</div>
</div>

<div id="outline-container-orgb6f18b3" class="outline-3">
<h3 id="orgb6f18b3">给某个client设置快捷键</h3>
<div class="outline-text-3" id="text-orgb6f18b3">
<p>
client::keys(keys_array) 方法可以获取/设置某个client的快捷键
</p>
</div>
</div>

<div id="outline-container-orgaba8bcc" class="outline-3">
<h3 id="orgaba8bcc">关闭某个client</h3>
<div class="outline-text-3" id="text-orgaba8bcc">
<p>
client:kill() 关闭该client
</p>
</div>
</div>

<div id="outline-container-org69f4c90" class="outline-3">
<h3 id="org69f4c90">为某个client设置所属tag</h3>
<div class="outline-text-3" id="text-org69f4c90">
<p>
client:tags(tags_array) 方法获取/设置该client所属的tag
</p>
</div>
</div>

<div id="outline-container-orgaf6657b" class="outline-3">
<h3 id="orgaf6657b">移动client到某个tag</h3>
<div class="outline-text-3" id="text-orgaf6657b">
<p>
client:move_to_tag(targe) 将client移动到某个tag
</p>
</div>
</div>
</div>

<div id="outline-container-org64a61b5" class="outline-2">
<h2 id="org64a61b5">client中的signal处理</h2>
<div class="outline-text-2" id="text-org64a61b5">
<ul class="org-ul">
<li>当client对象中的某个属性发生改变时，会引发名为 <code>property::属性名</code> 的signal</li>

<li>当新client对象产生时，引发 <code>manage</code> 信号</li>

<li>当client获取到焦点时，引发 <code>focus</code> 信号,当失去焦点时，引发 <code>unfocus</code> 信号</li>

<li>当键盘或鼠标操作时，引发 <code>button::press</code>, <code>button::release</code>, <code>mouse::enter</code>, <code>mouse::leave</code>, <code>mouse::move</code></li>

<li>当client获取tag时，引发 <code>tagged</code> 信号，当失去tag时，引发 <code>untagged</code> 信号</li>
</ul>
</div>
</div>

</div>
</div>
<div>
  <div class="post-meta">
    <span title="post date" class="post-info">2018-06-10</span>
    <span title="last modification date" class="post-info">2018-06-10</span>
    <span title="tags" class="post-info"><a href="../../../../../tags/linux和它的小伙伴">linux和它的小伙伴</a></span>
    <span title="author" class="post-info">lujun9972</span>
  </div>
  <script src="../../../../../media/js/jquery-2.1.3.min.js"></script>
  <script src="../../../../../media/js/md5.min.js"></script>
  <section>
      <div id="gitalk-container"></div>
      <script type="text/javascript">
       var gitalk = new Gitalk({
           clientID: 'fdcb5d9da3f4acb4862c',
           clientSecret: 'dd0a16312a206782cb7669dcec5e96874ab48170',
           repo: 'lujun9972.github.com',
           owner: 'lujun9972',
           admin: ['lujun9972'],
           id: md5(location.pathname),      // Ensure uniqueness and length less than 50
           distractionFreeMode: false  // Facebook-like distraction free mode
       })
       gitalk.render('gitalk-container')
      </script>
  </section>
  <script src="../../../../../media/js/kdComment.js"></script>
      <script>
       var _hmt = _hmt || [];
       (function() {
           var hm = document.createElement("script");
           hm.src = "https://hm.baidu.com/hm.js?7bac4fd0247f69c27887e0d4e3aee41e";
           var s = document.getElementsByTagName("script")[0]; 
           s.parentNode.insertBefore(hm, s);
       })();
      </script>
  <div class="footer">
    <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 27.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
    <p>
      Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:travis &lt;at&gt; travis-job-6ca56851-549c-40d8-b9bf-4e004231bee1">lujun9972</a>
      &nbsp;&nbsp;-&nbsp;&nbsp;
      Powered by <a href="https://github.com/emacs-china/EGO" target="_blank">EGO</a><br/>
      Themed with <a href="https://github.com/kuangdash/emacs_love" target="_blank">emacs_love</a>
        <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="https://licensebuttons.net/l/by-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License" class="center"></a>
      <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
    </p>
  </div>
    </div>

  </body>
</html>
